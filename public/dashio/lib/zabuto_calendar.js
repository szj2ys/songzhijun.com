if("undefined"==typeof jQuery)throw new Error("jQuery is not loaded");$.fn.zabuto_calendar=function(a){var e=$.extend({},$.fn.zabuto_calendar_defaults(),a),t=$.fn.zabuto_calendar_language(e.language);return e=$.extend({},e,t),this.each((function(){var a=$(this);function t(a,e,d,l){var c=new Date(d,l,1,0,0,0,0);return a.data("currDate",c),e.empty(),e=function(a,e,n,r){var d=a.data("navIcons"),o=$('<span><span class="fa fa-chevron-left text-transparent"></span></span>'),i=$('<span><span class="fa fa-chevron-right text-transparent"></span></span>');"object"==typeof d&&("prev"in d&&o.html(d.prev),"next"in d&&i.html(d.next));var l=a.data("showPrevious");"number"!=typeof l&&!1!==l||(l=s(a.data("showPrevious"),!0));var c=$('<div class="calendar-month-navigation"></div>');c.attr("id",a.attr("id")+"_nav-prev"),c.data("navigation","prev"),!1!==l&&(prevMonth=r-1,prevYear=n,-1==prevMonth&&(prevYear-=1,prevMonth=11),c.data("to",{year:prevYear,month:prevMonth+1}),c.append(o),"function"==typeof a.data("actionNavFunction")&&c.click(a.data("actionNavFunction")),c.click((function(n){t(a,e,prevYear,prevMonth)})));var u=a.data("showNext");"number"!=typeof u&&!1!==u||(u=s(a.data("showNext"),!1));var v=$('<div class="calendar-month-navigation"></div>');v.attr("id",a.attr("id")+"_nav-next"),v.data("navigation","next"),!1!==u&&(nextMonth=r+1,nextYear=n,12==nextMonth&&(nextYear+=1,nextMonth=0),v.data("to",{year:nextYear,month:nextMonth+1}),v.append(i),"function"==typeof a.data("actionNavFunction")&&v.click(a.data("actionNavFunction")),v.click((function(n){t(a,e,nextYear,nextMonth)})));var p=a.data("monthLabels"),b=$("<th></th>").append(c),h=$("<th></th>").append(v),f=$("<span>"+p[r]+" "+n+"</span>");f.dblclick((function(){var n=a.data("initDate");t(a,e,n.getFullYear(),n.getMonth())}));var m=$('<th colspan="5"></th>');m.append(f);var g=$('<tr class="calendar-month-header"></tr>');return g.append(b,m,h),e.append(g),e}(a,e,d,l),e=function(a,e){if(!0===a.data("showDays")){var t=a.data("weekStartsOn"),n=a.data("dowLabels");if(0===t){var r=$.extend([],n);n=new Array(r.pop()).concat(r)}var d=$('<tr class="calendar-dow-header"></tr>');$(n).each((function(a,e){d.append("<th>"+e+"</th>")})),e.append(d)}return e}(a,e),e=function(a,e,t,d){a.data("ajaxSettings");var l=function(a,e){var t=i(a,e),n=o(a,e,1),r=o(a,e,t),d=t,l=n-r;l>0&&(d+=l);return Math.ceil(d/7)}(t,d),s=i(t,d),c=o(t,d,1),u=o(t,d,s),v=1;0===a.data("weekStartsOn")&&(6==u&&l++,6!=c||0!=u&&1!=u&&5!=u||l--,7==++c&&(c=0));for(var p=0;p<l;p++){for(var b=$('<tr class="calendar-dow"></tr>'),h=0;h<7;h++){if(h<c||v>s)b.append("<td></td>");else{var f=a.attr("id")+"_"+r(t,d,v),m=$('<div id="'+(f+"_day")+'" class="day" >'+v+"</div>");m.data("day",v),!0===a.data("showToday")&&n(t,d,v)&&m.html('<span class="badge badge-today">'+v+"</span>");var g=$('<td id="'+f+'"></td>');g.append(m),g.data("date",r(t,d,v)),g.data("hasEvent",!1),"function"==typeof a.data("actionFunction")&&(g.addClass("dow-clickable"),g.click((function(){a.data("selectedDate",$(this).data("date"))})),g.click(a.data("actionFunction"))),b.append(g),v++}6==h&&(c=0)}e.append(b)}return e}(a,e,d,l),function(a,e,t){var n=a.data("ajaxSettings");if(a.data("events",!1),!1===n)return!0;if("object"!=typeof n||void 0===n.url)return alert("Invalid calendar event settings"),!1;var r={year:e,month:t+1};$.ajax({type:"GET",url:n.url,data:r,dataType:"json"}).done((function(e){var t=[];$.each(e,(function(a,n){t.push(e[a])})),a.data("events",t),function(a){var e=a.data("ajaxSettings"),t=a.data("events");!1!==t&&$(t).each((function(t,n){var r=a.attr("id")+"_"+n.date,d=$("#"+r),o=$("#"+r+"_day");if(d.data("hasEvent",!0),void 0!==n.title&&d.attr("title",n.title),void 0===n.classname?d.addClass("event"):(d.addClass("event-styled"),o.addClass(n.classname)),void 0!==n.badge&&!1!==n.badge){var i=!0===n.badge?"":" badge-"+n.badge,l=o.data("day");o.html('<span class="badge badge-event'+i+'">'+l+"</span>")}if(void 0!==n.body&&"modal"in e&&!0===e.modal){d.addClass("event-clickable");var s=function(a,e,t,n){var r=$('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'),d=$('<h4 class="modal-title" id="'+a+'_modal_title">'+e+"</h4>"),o=$('<div class="modal-header"></div>');o.append(r),o.append(d);var i=$('<div class="modal-body" id="'+a+'_modal_body">'+t+"</div>"),l=$('<div class="modal-footer" id="'+a+'_modal_footer"></div>');if(void 0!==n){var s=$("<div>"+n+"</div>");l.append(s)}var c=$('<div class="modal-content"></div>');c.append(o),c.append(i),c.append(l);var u=$('<div class="modal-dialog"></div>');u.append(c);var v=$('<div class="modal fade" id="'+a+'_modal" tabindex="-1" role="dialog" aria-labelledby="'+a+'_modal_title" aria-hidden="true"></div>');return v.append(u),v.data("dateId",a),v.attr("dateId",a),v}(r,n.title,n.body,n.footer);$("body").append(s),$("#"+r).click((function(){$("#"+r+"_modal").modal()}))}}))}(a)}))}(a,d,l),e}function n(a,e,t){var n=new Date;return new Date(a,e,t).toDateString()==n.toDateString()}function r(a,e,t){return d=t<10?"0"+t:t,m=e+1,m=m<10?"0"+m:m,a+"-"+m+"-"+d}function o(a,e,t){var n=new Date(a,e,t,0,0,0,0).getDay();return 0==n?n=6:n--,n}function i(a,e){for(var t=28;l(a,e+1,t+1);)t++;return t}function l(a,e,t){return e>0&&e<13&&a>0&&a<32768&&t>0&&t<=new Date(a,e,0).getDate()}function s(e,t){!1===e&&(e=0);var n,r=a.data("currDate"),d=a.data("initDate");if(n=12*(d.getFullYear()-r.getFullYear()),n-=r.getMonth()+1,n+=d.getMonth(),!0===t){if(n<parseInt(e)-1)return!0}else if(n>=0-parseInt(e))return!0;return!1}a.attr("id","zabuto_calendar_"+Math.floor(99999*Math.random()).toString(36)),a.data("initYear",e.year),a.data("initMonth",e.month),a.data("monthLabels",e.month_labels),a.data("weekStartsOn",e.weekstartson),a.data("navIcons",e.nav_icon),a.data("dowLabels",e.dow_labels),a.data("showToday",e.today),a.data("showDays",e.show_days),a.data("showPrevious",e.show_previous),a.data("showNext",e.show_next),a.data("cellBorder",e.cell_border),a.data("ajaxSettings",e.ajax),a.data("legendList",e.legend),a.data("actionFunction",e.action),a.data("actionNavFunction",e.action_nav),function(){var e=parseInt(a.data("initYear")),n=parseInt(a.data("initMonth"))-1,r=new Date(e,n,1,0,0,0,0);a.data("initDate",r);var d=!0===a.data("cellBorder")?" table-bordered":"";$tableObj=$('<table class="table'+d+'"></table>'),$tableObj=t(a,$tableObj,r.getFullYear(),r.getMonth()),$legendObj=function(a){var e=$('<div class="legend" id="'+a.attr("id")+'_legend"></div>'),t=a.data("legendList");"object"==typeof t&&t.length>0&&$(t).each((function(a,t){if("object"==typeof t&&"type"in t){var n="";switch("label"in t&&(n=t.label),t.type){case"text":if(""!==n){var r="";if("badge"in t){if(void 0===t.classname)var d="badge-event";else d=t.classname;r='<span class="badge '+d+'">'+t.badge+"</span> "}e.append('<span class="legend-'+t.type+'">'+r+n+"</span>")}break;case"block":if(""!==n&&(n="<span>"+n+"</span>"),void 0===t.classname)var o="event";else o="event-styled "+t.classname;e.append('<span class="legend-'+t.type+'"><ul class="legend"><li class="'+o+'"></li></u>'+n+"</span>");break;case"list":if("list"in t&&"object"==typeof t.list&&t.list.length>0){var i=$('<ul class="legend"></u>');$(t.list).each((function(a,e){i.append('<li class="'+e+'"></li>')})),e.append(i)}break;case"spacer":e.append('<span class="legend-'+t.type+'"> </span>')}}}));return e}(a);var o=$('<div class="zabuto_calendar" id="'+a.attr("id")+'"></div>');o.append($tableObj),o.append($legendObj),a.append(o)}()})),this},$.fn.zabuto_calendar_defaults=function(){var a=new Date;return{language:!1,year:a.getFullYear(),month:a.getMonth()+1,show_previous:!0,show_next:!0,cell_border:!1,today:!1,show_days:!0,weekstartson:1,nav_icon:!1,ajax:!1,legend:!1,action:!1,action_nav:!1}},$.fn.zabuto_calendar_language=function(a){switch(void 0!==a&&!1!==a||(a="en"),a.toLowerCase()){case"de":return{month_labels:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dow_labels:["Mo","Di","Mi","Do","Fr","Sa","So"]};case"en":return{month_labels:["January","February","March","April","May","June","July","August","September","October","November","December"],dow_labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]};case"es":return{month_labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dow_labels:["Lu","Ma","Mi","Ju","Vi","Sá","Do"]};case"fr":return{month_labels:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dow_labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"]};case"it":return{month_labels:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dow_labels:["Lun","Mar","Mer","Gio","Ven","Sab","Dom"]};case"nl":return{month_labels:["Januari","Februari","Maart","April","Mei","Juni","Juli","Augustus","September","Oktober","November","December"],dow_labels:["Ma","Di","Wo","Do","Vr","Za","Zo"]}}};